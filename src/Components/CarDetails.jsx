import React, { useState, useEffect } from 'react';
import CarList from './CarList';
import CurrentPage from './CurrentPage';

const CarApp = ({ onMoreDetailsClick }) => {
  const [cars, setCars] = useState([]);
  const [currentPage, setCurrentPage] = useState(1);
  const carsPerPage = 6; // Fixed to showing 6 cars per page

  useEffect(() => {
    // Mock API call to fetch cars
    const fetchCars = async () => {
      const carData = [
        // Sample car data

{
    "id": 295966389,
    "vin": "3N1AB7AP9KY272383",
    "year": 2019,
    "make": "Nissan",
    "model": "Sentra",
    "price": "$13,499",
    "mileage": "40,396 Miles",
    "city": "Santa Ana",
    "state": "CA",
    "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/09/11/04/11/2019_nissan_sentra-pic-6923325555976142555-1024x768.jpeg",
    "trim": "S",
    "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link"
  },
  {
    "id": 295072926,
    "vin": "5TFCZ5AN9MX269492",
    "year": 2021,
    "make": "Toyota",
    "model": "Tacoma",
    "price": "$47,499",
    "mileage": "41,617 Miles",
    "city": "Santa Ana",
    "state": "CA",
    "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/08/28/05/11/2021_toyota_tacoma-pic-4967524110423818927-1024x768.jpeg",
    "trim": "SR V6",
    "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link"
  },
  {
    "id": 284203092,
    "vin": "5UXTS1C06M9H02674",
    "displayColor": "Alpine White",
    "year": 2021,
    "make": "BMW",
    "model": "X3",
    "price": "$31,099",
    "mileage": "20,456 Miles",
    "city": "Santa Ana",
    "lat": 33.7687,
    "lon": -117.851,
    "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/03/13/02/12/2021_bmw_x3-pic-2244009518592138739-1024x768.jpeg",
    "condition": "used",
    "providerId": 199,
    "createdAt": "2024-03-06T04:37:14.860Z",
    "updatedAt": "2024-06-01T17:41:39.588Z",
    "modelId": 1323,
    "dealerName": "California Motors Direct",
    "active": true,
    "state": "CA",
    "trim": "xDrive30e",
    "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
    "acceptsLeads": true,
    "bodyType": "suv",
    "bodyStyle": "suv",
    "regionName": null,
    "experience": "local",
    "requiresAddressWithLead": false,
   
    },
    {
        "id": 294896080,
        "vin": "5YJ3E1EB5MF999513",
        "displayColor": "Deep Blue Metallic",
        "year": 2021,
        "make": "Tesla",
        "model": "Model 3",
        "price": "$26,061",
        "mileage": "37,567 Miles",
        "city": "Santa Ana",
        "lat": 33.7687,
        "lon": -117.851,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/08/27/13/51/2021_tesla_model_3-pic-4810606719225207085-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-08-17T17:51:25.971Z",
        "updatedAt": "2024-09-14T03:39:48.028Z",
        "modelId": 2217,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "Long Range",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "sedan",
        "bodyStyle": "sedan",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
    
    {
        "id": 294702522,
        "vin": "JF2GTABCXMH358959",
        "displayColor": "Crystal White Pearl",
        "year": 2021,
        "make": "Subaru",
        "model": "Crosstrek",
        "price": "$21,271",
        "mileage": "51,148 Miles",
        "city": "Santa Ana",
        "lat": 33.7687,
        "lon": -117.851,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/08/20/14/37/2021_subaru_crosstrek-pic-1928819675295941467-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-08-15T03:33:15.275Z",
        "updatedAt": "2024-09-11T03:38:15.051Z",
        "modelId": 1076,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "Base",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "wagon",
        "bodyStyle": "crossover",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
    {
        "id": 295072928,
        "vin": "JN1AZ4EH6KM422711",
        "displayColor": "Magnetic Black Metallic",
        "year": 2019,
        "make": "Nissan",
        "model": "370Z",
        "price": "$26,599",
        "mileage": "46,626 Miles",
        "city": "Santa Ana",
        "lat": 33.7687,
        "lon": -117.851,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/08/31/22/21/2019_nissan_370z-pic-3233926508262320922-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-08-21T03:37:07.878Z",
        "updatedAt": "2024-09-11T17:58:57.837Z",
        "modelId": 1484,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "Base",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "coupe",
        "bodyStyle": "coupe",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
    {
        "id": 294702526,
        "vin": "KL4CJASB7KB836808",
        "displayColor": "Winterberry Red Metallic",
        "year": 2019,
        "make": "Buick",
        "model": "Encore",
        "price": "$14,399",
        "mileage": "59,648 Miles",
        "city": "Santa Ana",
        "lat": 33.768902,
        "lon": -117.851429,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/08/29/11/03/2019_buick_encore-pic-7082532358775738528-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-08-15T03:33:15.396Z",
        "updatedAt": "2024-09-14T17:45:54.730Z",
        "modelId": 1924,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "Preferred",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "suv",
        "bodyStyle": "suv",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
    {
        "id": 284077727,
        "vin": "W1N0G8DB1LF797391",
        "displayColor": "White",
        "year": 2020,
        "make": "Mercedes-Benz",
        "model": "GLC",
        "price": "$22,789",
        "mileage": "43,092 Miles",
        "city": "Santa Ana",
        "lat": 33.768902,
        "lon": -117.851429,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/06/27/03/29/2020_mercedes-benz_glc-pic-6569726137606607835-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-03-03T04:46:15.572Z",
        "updatedAt": "2024-08-16T03:36:34.028Z",
        "modelId": 2104,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "GLC 300",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "suv",
        "bodyStyle": "suv",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
    {
        "id": 295424532,
        "vin": "WA1AUCF30M1059460",
        "displayColor": "Ibis White",
        "year": 2021,
        "make": "Audi",
        "model": "Q3",
        "price": "$21,799",
        "mileage": "63,242 Miles",
        "city": "Santa Ana",
        "lat": 33.7687,
        "lon": -117.851,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/09/06/21/04/2021_audi_q3-pic-1302257140187203070-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-08-25T03:38:43.126Z",
        "updatedAt": "2024-09-11T17:58:59.932Z",
        "modelId": 2052,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "quattro Premium 40 TFSI",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "suv",
        "bodyStyle": "suv",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
    {
        "id": 289649225,
        "vin": "WBS3C9C54FP804486",
        "displayColor": "Mineral Grey Metallic",
        "year": 2015,
        "make": "BMW",
        "model": "M3",
        "price": "$38,599",
        "mileage": "67,239 Miles",
        "city": "Santa Ana",
        "lat": 33.7687,
        "lon": -117.851,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/09/07/04/09/2015_bmw_m3-pic-3172028361802722410-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-05-28T17:33:30.494Z",
        "updatedAt": "2024-09-11T03:38:07.789Z",
        "modelId": 1321,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "Base",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "sedan",
        "bodyStyle": "sedan",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
    {
        "id": 293205163,
        "vin": "2C3CCARG7GH351329",
        "displayColor": "Bright White Clearcoat",
        "year": 2016,
        "make": "Chrysler",
        "model": "300",
        "price": "$16,999",
        "mileage": "57,896 Miles",
        "city": "Santa Ana",
        "lat": 33.7687,
        "lon": -117.851,
        "primaryPhotoUrl": "https://auto.dev/images/forsale/2024/08/14/08/31/2016_chrysler_300-pic-761265925333623956-1024x768.jpeg",
        "condition": "used",
        "providerId": 199,
        "createdAt": "2024-07-23T17:44:54.957Z",
        "updatedAt": "2024-09-11T03:37:21.696Z",
        "modelId": 1307,
        "dealerName": "California Motors Direct",
        "active": true,
        "state": "CA",
        "trim": "Limited",
        "clickoffUrl": "www.ocmotorsdirect1.com?utm_source=autodev&utm_medium=referral&utm_campaign=vdp_deep_link",
        "acceptsLeads": true,
        "bodyType": "sedan",
        "bodyStyle": "sedan",
        "regionName": null,
        "experience": "local",
        "requiresAddressWithLead": false,
    },
        {
          id: 295652399,
          vin: "2HGFE2F55NH521732",
          year: 2022,
          make: "Honda",
          model: "Civic",
          price: "$24,299",
          mileage: "14,536 Miles",
          city: "Santa Ana",
          primaryPhotoUrl: "https://auto.dev/images/forsale/2024/09/05/09/50/2022_honda_civic-pic-2795251154945959741-1024x768.jpeg",
          condition: "used",
          state: "CA",
          trim: "Sport",
        },
        {
          id: 294608953,
          vin: "2HKRW1H89NH402096",
          year: 2022,
          make: "Honda",
          model: "CR-V",
          price: "$24,699",
          mileage: "36,652 Miles",
          city: "Santa Ana",
          primaryPhotoUrl: "https://auto.dev/images/forsale/2024/08/20/12/44/2022_honda_cr-v-pic-3855404807593210080-1024x768.jpeg",
          condition: "used",
          state: "CA",
          trim: "EX-L",
        },
        // Add the remaining car data...
      ];
      setCars(carData);
    };

    fetchCars();
  }, []);

  // Calculate total number of pages
  const totalPages = Math.ceil(cars.length / carsPerPage);

  // Get current cars to display based on pagination
  const indexOfLastCar = currentPage * carsPerPage;
  const indexOfFirstCar = indexOfLastCar - carsPerPage;
  const currentCars = cars.slice(indexOfFirstCar, indexOfLastCar);

  // Handle page change
  const handlePageChange = (pageNumber) => {
    setCurrentPage(pageNumber);
  };

  return (
    <div className="container mx-auto p-4 ">
      <h1 className="text-5xl font-extrabold mb-10 text-gray-400 ">Available Cars</h1>

      {/* Car List */}
      <CarList cars={currentCars} onMoreDetailsClick={onMoreDetailsClick} />

      {/* Pagination Controls */}
      <CurrentPage
        currentPage={currentPage}
        handlePageChange={handlePageChange}
        totalPages={totalPages}
      />
    </div>
  );
};

export default CarApp;
